stages:
  - build
  - deploy

build_backend:
  stage: build
  script:
    - cd /ssbd/api
    - git pull
    - mvn clean package -DskipTests
  tags:
    - backend-shell
  only:
    - main

deploy_backend:
  stage: deploy
  script:
    - cd /ssbd/docker
    - docker compose build backend
    - docker compose up -d --no-deps --force-recreate backend
    -  mvn liquibase:update
  tags:
    - backend-shell
  only:
    - main